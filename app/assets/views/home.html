<section class="container">
    <div>
        <div ng-repeat="post in postCtrl.getAllPosts() | orderBy :'-votes' ">

            <!-- VOTES -->
            <div id="post-feed" class="row">
                <div class="col s2 m2 l1">
                    <a href="#"><i ng-click="postCtrl.upvotePost(post)" class="material-icons arrow right">arrow_drop_up</i></a>
                    <p class="post-votes" ng-cloak>{{post.votes}}</p>
                    <a href="#"><i ng-click="postCtrl.downvotePost(post)" class="material-icons arrow right">arrow_drop_down</i></a>
                </div>
                <!-- CARD -->
                <div class="col s10 m10 l11">
                    <div class="card horizontal">
                        <div class="card-image">
                            <div class="post-image">
                                <img ng-src="{{post.postImage}}" ng-cloak>
                            </div>
                        </div>
                        <div class="card-stacked">
                            <div class="card-content">
                                <p>
                                    <h6 class="header" ng-cloak>{{post.postTitle}}<a ng-href="{{post.postUrl}}" target="_blank" ng-cloak><i class="material-icons open-new">open_in_new</i></a></h6>
                                </p>
                                <p ng-cloak>{{post.postText | limitTo:255 }}</p>
                            </div>
                            <div class="card-action">
                                <div class="presentation">
                                    <gs-favorite></gs-favorite>
                                    <a ngModel="color" ui-sref="singlepost" ng-click="postCtrl.loadPost(post)"><i class="material-icons open-new right">remove_red_eye</i></a></a>
                                    <a href="#"><i class="material-icons view-comment" ng-click="showComments = !showComments">comments</i></a></a>
                                    <a href="#"><i class="material-icons comment" ng-click="makeComment = !makeComment">note_add</i></a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Make Comment INPUT -->
                    <div ng-controller="CommentsCtrl as commentsCtrl">
                        <div ng-show="makeComment" class="collapsible-header">
                            <input ng-model="commentsCtrl.comment" type="text" name="comment" id="comment_content" class="col s11 m11 l11" placeholder="Make a comment.">
                            <a href="" type="submit" class="col s1 m1 l1 black-text comment" ng-click="commentsCtrl.createComment(post.id)"><i class="material-icons">check_circle</i></a>

                        </div>

                        <!-- Show Comments -->
                        <div class="row">
                            <div class="col s12 m12 l12">
                                <div ng-show="showComments">
                                    <div class="card">
                                        <div ng-repeat="comment in commentsCtrl.getPostComments() | filter: comment.postId ">
                                            <div class="comment-list-box">
                                                <ul class="comment-list">
                                                    <li class="comment-list-item">{{comment.commentContent}}
                                                        <a class="btn-flat right" ng-click="commentsCtrl.deleteComment(comment.postId)">x</a> </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- </div>
                    </div> -->

                        </div>
                    </div>
                </div>
            </div>


</section>
